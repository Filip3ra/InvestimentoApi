<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Calculadora de Investimento</title>
  </head>
  <body>
    <h2>Calculadora de Tempo para R$ 100.000</h2>

    <label for="valorMensal">Valor investido mensalmente (R$):</label>
    <input type="number" id="valorMensal" required />
    <br />

    <label for="taxa">Taxa de investimento (%):</label>
    <input type="number" id="taxa" required />

    <select id="periodicidade">
      <option value="anual">Anual</option>
      <option value="mensal">Mensal</option>
      <option value="trimestral">Trimestral</option>
      <option value="semestral">Semestral</option>
    </select>
    <br />

    <label for="inflacaoAnual">Taxa de inflação anual (%):</label>
    <input type="number" id="inflacaoAnual" required />
    <br />

    <button onclick="CalcularInvestimento()">Calcular</button>
    <p id="resultado"></p>

    <!--
    document.getElementById("valorMensal"): Obtém o elemento HTML com o id="valorMensal"
    .value: Pega o valor digitado pelo usuário


    
    -->

    <script>
      async function CalcularInvestimento() {
        let valorMensal = document.getElementById("valorMensal").value;
        let taxa = document.getElementById("taxa").value;
        let periodicidade = document.getElementById("periodicidade").value;
        let inflacaoAnual = document.getElementById("inflacaoAnual").value;

        // Validação dos campos: vazio, null, undefined
        if (!valorMensal || !taxa || !periodicidade || !inflacaoAnual) {
          document.getElementById("resultado").innerText =
            "Preencha todos os campos.";
          return;
        }

        //url: é uma string contendo o endereço da API com os valores inseridos pelo usuário usada para fazer requisição GET
        let url = `http://localhost:5179/api/investimento/calcular?valorMensal=${valorMensal}&taxa=${taxa}&periodicidade=${periodicidade}&inflacaoAnual=${inflacaoAnual}`;

        try {
          /*
          fetch: requisição http, nesse caso o GET
          await: como pode demorar a requisição, vamos esperar a resposta
          */
          let response = await fetch(url);
          let data = await response.json(); // converte resposta da api (.json) para objeto JS (data)
          document.getElementById(
            "resultado"
          ).innerText = `Você atingirá R$ 100.000 em aproximadamente ${data.anos} anos e ${data.meses} meses.`;
        } catch (error) {
          console.error("Erro na requisição:", error);
          alert("Erro ao calcular. Verifique os valores e tente novamente.");
        }
      }
    </script>
  </body>
</html>
